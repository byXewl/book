D盾：主机上扫木马等。
河马：主机上扫木马等。
GScan等。


## **HIDS**
HIDS（Host-based Intrusion Detection System）：主机入侵检测系统 是一种用于监视和分析单个主机上的安全事件和异常活动的安全工具。HIDS 安装在操作系统内部，检测和响应可能表示入侵或威胁的行为，如异常进程活动、未经授权的文件访问、异常网络流量等。



## **EDR**
终端安全响应系统
IPS 主要针对网络流量，而 EDR 则专注于终端设备上的安全事件监控和响应(监控主机进程，网络连接等)。
EDR可以基于HIDS。
在 EDR 解决方案中，通常有一个集中式的管理控制台，用于管理和监控多台终端设备。这个管理控制台通过代理程序或客户端软件与各个终端设备通信，收集终端设备的安全事件数据，并进行实时分析和响应。

**端点**：台式机、服务器、移动设备和嵌人式设备等。攻击者往往首先利用目标网络中的脆弱端点建立桥头堡，再通过进一步的漏洞利用来构筑长期驻留条件，最终迈向既定目标。
**端点检测与响应**（Endpoint Detection and Response，EDR）：完全不同于以往的端点被动防护思路，而是通过云端威胁情报、机器学习、异常行为分析、攻击指示器等方式，主动发现来自外部或内部的安全威胁，并进行自动化的阻止、取证、补救和溯源，从而有效对端点进行防护。

**举例**：
360天擎终端检测与响应系统，融入了360威胁情报、大数据安全分析等功能，可以实时检测用户端点的异常行为和漏洞，通过与360威胁情报对比，能够及时发现威胁，做出木马隔离和漏洞修补的安全响应。
<https://zhuanlan.zhihu.com/p/564398361>


**功能模块**：
EDR（终端检测与响应）系统的最重要功能之一是取证模块。取证模块负责收集、分析和保存有关终端系统和网络活动的数据，以便进行后续的调查、分析和取证工作。具体来说，取证模块的功能包括：

1. **数据收集**：取证模块收集终端系统的各种数据，包括进程信息、文件系统活动、注册表操作、网络连接、用户活动等。这些数据通常来自于终端系统上运行的代理程序或传感器。
2. **事件分析**：取证模块对收集到的数据进行分析，识别出可能的安全事件和异常行为。这可能涉及到使用各种检测技术，如基于规则、机器学习、行为分析等。
3. **取证存储**：取证模块将收集到的数据存储在安全数据湖或其他存储介质中，以便后续的调查和取证工作。存储的数据通常包括原始事件日志、元数据、分析结果等。
4. **调查支持**：取证模块提供用户界面和工具，以便安全分析人员进行调查和取证工作。这可能包括搜索和查询功能、可视化工具、报告生成等。
5. **合规性和法律支持**：取证模块帮助组织满足合规性要求，并支持法律诉讼和调查工作。它可以提供审计日志、证据链等信息，以支持取证过程的合法性和可信度。


## **EDR/IDS设备**

suricata-rules：检测规则，支持CobaltStrike/MSF/Empire/DNS隧道/Weevely/菜刀/冰蝎/挖矿/反弹shell/ICMP隧道等。

Elkeid：Ekeid是字节跳动一个云原生的基于主机的安全（入侵检测与风险识别）解决方案，作者详细的描述了项目架构。

OSSEC：一款开源的IDS检测系统，包括了日志分析、完整性检查、rook-kit检测，基于时间的警报和主动响应。

Wazuh：一个免费的，开源的企业级安全监控解决方案，用于威胁检测，完整性监控，事件响应和合规性。
基于ELK的EDR系统。

Suricata：一个免费的开源，成熟，快速和强大的网络威胁检测引擎。Snort：网络入侵检测和预防系统。

