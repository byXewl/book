挖矿病毒：挖比特币等虚拟币的程序。
特征：内存，cpu占用99%，利用GPU算力。

## **简介**
* 挖矿（Mining），早期与比特币有关，用户使用个人计算机下载软件，然后运行特定的算法，与远方服务器通信后得到相应比特币，挖矿就是利用比特币挖矿赚取比特币。
* 挖矿的过程就是创建分布式数据库（即区块链）中的一个新区块。每个区块包含了一定数量的交易记录以及指向前一个区块的哈希值。矿工通过解决数学难题（算力）来竞争创建新的区块，并将其添加到区块链中，这个过程确保了比特币网络中交易的顺序和安全性，并通过工作证明机制保护了网络免受恶意攻击。因此，挖矿可以被视为创建和维护分布式数据库（区块链）的一部分过程。
* 由于挖矿成本过于高昂，一些不法分子通过各种手段将矿机程序植入受害者的计算机中，利用受害者计算机的运算力进行挖矿，从而获取非法收益。这类非法侵入用户计算机的矿机程序被称作挖矿木马。
* 挖矿木马进行超频运算时占用大量CPU资源，导致计算机上其他应用无法正常运行。不法分子为了使用更多算力资源，一般会对全网主机进行漏洞扫描、SSH爆破等攻击手段。部分挖矿木马还具备横向传播的特点，在成功入侵一台主机后，尝试对内网其他机器进行蠕虫式的横向渗透，并在被入侵的机器上持久化驻留，长期利用机器挖矿获利。
* 挖矿程序通常会与矿池的 IP 地址以及矿工的钱包地址(以太坊的地址通常以"0x"开头 42 位字符串，比特币的地址通常以"1"或"1/3/bc1"开头)进行外联TCP通信。
常见的挖矿协议：GETWORK Getblocktemplate协议 STRATUM

## **常见的挖矿木马**

* **Mykings（隐匿者）**
  主要利用“永恒之蓝”漏洞，针对 MsSQL、Telnet、RDP、CCTV等系统组件或设备进行密码暴力破解，暴力破解成功后，利用扫描攻击进行蠕虫式传播。Mykings不仅局限于挖矿获利，还与其他黑产家族合作完成锁首页，DDoS 攻击等
* **8220Miner**
  因固定使用 8220 端口而被命名。利用多个漏洞进行攻击和部署挖矿程序，是一个长期活跃的组织，也是最早使用 Hadoop Yarn 未授权访问漏洞攻击的挖矿木马，除此之外，还是用了多种其他的Web 服务漏洞。8220 Miner 没有采用蠕虫式的传播，而是使用固定一组 IP 地址进行全网攻击，为了持久化驻留，使用了 rootkit 技术进行自我隐藏。
* **WannaMine**
   采用“无文件”攻击组成挖矿僵尸网络，最早在2017年底被发现，攻击时执行远程Powershell代码，全程无文件落地。为了隐藏其恶意行为，WannaMine还会通过WMI类属性存储shellcode, 并使用“永恒之蓝”漏洞攻击武器以及“Mimikatz+WMIExec”攻击组件进行横向渗透。
  2018年6月，WannaMine 增加了 DDoS 模块，改变了以往的代码风格和攻击手法。2019年4月，WannaMine 舍弃了原有的隐匿策略，启用新的 C2 地址存放恶意代码，采用Powershell 内存注入执行挖矿程序和释放PE木马挖矿的方法进行挖矿，增大了挖矿程序执行的概率。

## **攻击步骤**
使用一些rce漏洞，redis未授权，系统漏洞。一般是Linux程序。

1、信息收集
使用nmap命令对目标主机进行扫描。
```
nmap -T4 -sT 目标IP地址  
```
2、爆破SSH
```
hydra -L 用户字典 -P 密码字典 ssh://目标IP
```
3、sftp连接目标
由于SSH和sftp通用一个端口
```
sftp root@目标IP
```

4、上传木马
```
put 本机木马文件 目标目录
```
 5、执行挖矿木马
```
ssh root@靶机ip
```
赋予权限
```
chmod 777 挖矿木马文件
```
执行木马文件，可能就是个.sh全自动脚本
```
 ./木马文件
```


## **传播方式**
```
• 利用漏洞传播
• 通过弱口令爆破传播
• 通过僵尸网络传播
• 采用无文件攻击方法传播
• 利用网页挂马传播
• 利用软件供应链攻击传播
• 利用社交软件、邮件传播
• 内部人员私自安装和运行挖矿程序
```

## **处置方法**
1. 隔离被感染的服务器或主机
2. 确认挖矿进程
3. 清除挖矿木马
* 阻断矿池地址连接
* 清除挖矿定时任务、启动项等
* 定位挖矿木马文件的位置，并清除

## **清除木马**

* 从内网DNS服务器、DNS防火墙、流量审计设备等设备获取恶意域名信息，根据域名查询威胁情报确定木马类型
* 查看系统CPU、内存、网络占用情况，获取异常进程相关信息
* 根据进程名或部分字符串获取进程号或进程相关的命令行命令
* 根据进程号查看由进程运行的线程
* 结束挖矿进程及其守护进程
* 通过挖矿进程的相关信息，定位到文件的具体位置，删除恶意文件
* 查看启动项，如果发现非法开机自启服务项，停止并删除对应数据
* 查看定时任务
* 溯源挖矿木马入侵途径，查找系统漏洞，打上对应补丁，完成漏洞修复，防止再次入侵

## **防护建议**

* 规范上网行为，不安装来历不明的软件、工具
* 不打开来历不明的文档，以及带有图片、文件夹、文档、音视频等图标的文件
* 进行严格的隔离，有关系统、服务尽量不要开放到互联网，在内网中的系统也要通过防火墙、VLAN或网闸等进行隔离。对于系统要采取最小化服务的原则，只提供必要的服务无关的服务必须要关闭，同时采用本机防火墙进行访问要进行访问控制
* 及时安装系统补丁，修复系统应用漏洞、中间件漏洞、组件、插件等相关漏洞
* 加强密码策略，增加密码复杂度并进行定期修改，开启相关登录失败处理功能
* 服务器定期维护



^
## **拓展知识：交易所平台**

**“中心化交易所”（Centralized Exchange，简称 CEX）标准的模样**，币安、OKX、火币、Coinbase 等都一样，核心特征可以浓缩成一句话：

**“充值→内部记账→撮合成交→提现”四步闭环，全程资产先归平台，再让你看到数字。**

具体对照表：

1. 开户\
   用邮箱/手机号注册，平台在**自己数据库**给你建账户，**不是链上地址**。
2. 入金\
   法币（RMB）→ 场外商家 → USDT 直接**划进你的平台资金账户**，链上无交易。
3. 交易\
   USDT/BTC 等所有买卖都在**平台订单簿里撮合**，只改余额，不改链。
4. 提币\
   只有当你点“提现”并填写外部地址时，平台才从**公司热钱包**发一笔链上转账，把真正的币打给你，同时扣矿工费。

如一整套“RMB→USDT→BTC”且全程只在 App 里看到数字变化，**正是中心化交易所的典型体验**：快、便宜、无需矿工费、无需自己管私钥，但代价是**资产瞬间变成对平台的债权**，必须等平台帮你“兑现”才算真正拥有链上币。

#### **交易兑现**
现货 = 直接买卖“真币”，一手交钱一手交币，盈亏只取决于买入后币价涨跌。
合约 = 买卖“合约头寸”，只交保证金（杠杆），盈亏按杠杆放大，可能被强平爆仓，不真正持有币。
>合约赚赔 = 方向 × 杠杆 × 波动幅度 × 仓位大小，外加资金费率、强平、滑点等变量。
>核心是把“现货价格变动”放大成高波动差价合约，你押对方向且幅度足够就盈利，反之亏损；平台只按价差结算 USDT，从不交割实物币。




如果用usdt余额交易买了某种币，暴涨1000倍，价值200w usdt。实际平台也在后台买了这个币吗？不然平台怎么给我兑现？

平台**根本不需要“提前”或“同步”去市场上买币**，也**不需要手里真有那么多币**才能让你账面盈利。它用三种办法就能“兑现”：

1. 100% 准备金 + 热钱包滚仓\
   对主流币（BTC、ETH、热门山寨）平台通常会在**自己热钱包里长期囤一批现货**（链上可查）。用户提现时直接从那批现货里拨给你即可，**跟它内部账本是不是 1000 倍没关系**——反正 1 枚就是 1 枚。价格涨跌由市场消化，平台只负责“数量”兑付。
2. 动态对冲（delta-neutral）\
   对成交活跃的品种，做市算法会实时把**净头寸风险**对冲到期货市场或外部流动性池里，保证“用户总盈利 ≈ 平台已锁定的对冲仓位”，这样即使币价翻 1000 倍，平台在衍生品端已提前锁定利润/亏损，**不会临时裸奔**。
3. 挤兑时现买现货\
   如果突然出现**巨量提现**（热钱包库存不够），平台立刻到链上市场、OTC、做市商网络**现买现提**，把短缺补平；只要它账上真有 200 w USDT 等价现金流（手续费沉淀、自有资金、借贷额度），就能秒补。对 200 w 美元级别的提现，头部交易所几分钟就能调货完成。

一句话：\
**交易所是“数量”兑付，不是“市值”兑付。**\
你看到的 200 w USDT 账面利润，平台只需在你提币那一刻**按 1:1 数量把币给你**即可；它平时只要保持足够的热钱包库存 + 现金流，就扛得住暴涨后的提现潮。价格风险要么由市场消化，要么由对冲仓位转移，**不会等币价翻 1000 倍才临时去“买币”**。


^
#### **USDT支付**
USDT 支付“有链”，而且有多条链可选；
转账方式分“链上”和“站内(商户接入扫码，无需关注链)”两种；
存在一定匿名性。

一、USDT 跑在哪些链上\
目前主流有三条，彼此地址格式不同、矿工费差异大，选错网络就会丢币：

1. Omni：最早，基于比特币网络，地址以 1/3 开头，矿工费最高，确认慢，已逐渐淘汰。
2. ERC-20：基于以太坊，地址以 0x 开头，矿工费按 ETH gas 收取，拥堵时较贵，兼容性最好。
3. TRC-20：基于波场，地址以 T 开头，矿工费几乎为 0、30 秒左右到账，是目前最常用的支付通道 [](https://m.jinse.cn/news/blockchain/1125564.html)。

二、怎么转账（链上版）

1. 打开钱包或交易所，选“提币→USDT”，再选网络（一定要与收款方支持的网络一致）。
2. 粘贴对方“收款地址”（相当于银行卡号），输入数量。
3. 支付矿工费（ERC-20 用 ETH，TRC-20 用 TRX 做能量费），输入资金密码/谷歌验证。
4. 等待链上确认：ERC-20 一般 1–5 分钟，TRC-20 约 30 秒即可到账。

三、怎么“扫码”付\
如果对方网站/商户接入了 **Binance Pay（USDT主流）**、**TokenPocket Pay** 、**USDT-TRC20 tether**等闭环支付，会生成一个二维码或跳转链接。你用币安/TP 等 App 直接扫码，确认后走“链下批量结算”，秒到且 0 矿工费，本质是把 USDT 从平台内部账户划给商户。

四、匿名性——地址公开，身份可关联

1. 链上角度：钱包地址=一串随机字符，无需实名即可创建，交易记录人人可查，但地址本身不挂身份，所以“半匿名”。
2. 现实角度：只要地址跟交易所、OTC、实名社交账号发生过交互，执法或分析公司就能通过 KYC 数据把地址与真人对应；因此大额非法资金仍可被追踪。
3. 增强隐私的做法：频繁换地址、用混币器、通过隐私币中转，但这些方法可能触及合规风险。

一句话总结\
USDT 支付要先把“链”选对（常用 TRC-20），再像复制银行卡号一样填地址或扫码；链上记录公开可查，但身份能否被锁定取决于你是否在实名环节留下痕迹。

^
#### **支付风控**
**虚拟货币出金被点**
“虚拟货币出金被点”＝ 你提币去向的地址，被平台风控系统或链上分析机构打上了「高风险 / 洗钱 / 涉案」标签（俗称“黑名单”）。

“被点了”= 你的出金路径（从交易所提币到外部地址，或再转法币）被平台的风控系统或链上分析机构打上“高风险”标签，触发临时冻结，并不是“币本身有问题”，而是地址或交易对手进了黑名单。具体分两种场景：
链上地址被“点”
你把币提到一个曾被举报、涉案、混币、网赌、电诈用过的地址；
交易所实时对接 Chainalysis、MistTrack 等数据库，一旦命中就立刻弹窗“该地址为风险地址，提币已被拦截”；
即使你只是场外卖 U，对方给的收币地址早被标记，平台也会反向冻结你的账户，要求你提交资金来源、聊天记录、对手方信息才能解冻。
法币出金被“点”
你把 USDT 卖给 OTC 商家 → 商家用银行卡转人民币给你；
这张银行卡此前收取过黑钱（电诈、洗钱），被公安部“保护性止付”或银行风控；
结果就是银行卡被冻结，同时交易所接到协查函，也会暂停你提币功能，直到你提供合法收入证明、交易流水、聊天记录等材料。
一句话：
“出金被点了”就是交易所或银行发现你的收款地址/收款账户曾在高风险链条里出现过，于是先冻结再盘问，跟“币有没有问题”无关，只要和风险地址发生交互就会触发。

^
**使用混币器**
“使用混币器”＝ 这笔资金在转出前先被送进了 Tornado Cash、CCE.Cash、Sinbad 等“混币”合约，把来源路径打乱，再分散到多个新地址，防止风控。

理论上混币器确实可以“拆断”链上链路，让分析方看不出“谁最终拿到币”；但在现实里，它只能延缓或增加追踪成本，远远做不到 100 % 防点，如Chainalysis、Elliptic、TRM Labs 把混币器资金池地址全部列进黑名单。只要你的币先进入这些池子，哪怕后面再转 10 手，交易平台仍能把“入池”这笔交易标记成高风险。





^
## **拓展知识：Web3钱包地址**
如果你用的是 Blockchain.com 钱包（Blockchain.com Wallet不是Exchange）：
这是真正的 Web3 钱包，你注册时会生成助记词（12 或 24 个英文单词），你有私钥/助记词的控制权。
你看到的 BTC 地址是链上真实地址，你可以导出私钥或助记词，导入到其他钱包（如 Electrum、MetaMask、Rabby 等）继续使用。
你可以直接接收、发送 BTC，所有交易都在链上完成，Blockchain.com 不托管你的资产（除非你主动开启云备份）。
所以，这种地址是 真正的 Web3 钱包地址。

^
同时币安也是可以的，「钱包」→ 顶部切换到「Web3」→ 首次使用会提示「创建或导入钱包」。


^



#### **助记词**


同一个助记词可以派生多条链的地址。具体规则如下：

1. 助记词 → 多链钱包\
   你导入的那 12/24 个单词是**根种子**，钱包会根据它自动算出 BTC、ETH、BSC、TRON 等不同网络的私钥和地址，所以：

   * 助记词备份一次即可恢复全部链资产；
   * 每条链的地址格式、余额、交易记录彼此独立。

2. 地址格式对照

   | 链        | 地址样式                 | 能否收 USDT                     |
   | :------- | :------------------- | :--------------------------- |
   | Bitcoin  | `1…` / `3…` / `bc1…` | 只能收 BTC（Omni-USDT 极少用）       |
   | Ethereum | `0x…`                | 可收 ERC-20 USDT 及所有 ERC-20 代币 |
   | BSC      | `0x…`                | 可收 BEP-20 USDT 及 BEP-20 代币   |
   | TRON     | `T…`                 | 可收 TRC-20 USDT 及 TRC-20 代币   |

3. **千万别跨链打款**\
   把 ERC-20 USDT 误打到 TRON 地址（或相反）会直接丢币；钱包界面会明确标注网络名称，转账前务必“**地址+网络**”双核对。

<!---->

4. 同一链上“一个地址”可以收无数种代币\
   例如 `0xabc…` 这个以太坊地址，可同时收 USDT、USDC、UNI、NFT 等所有 ERC-20/ERC-721 资产，只需在钱包里添加代币符号即可显示余额。


^
#### **助记词的派生**


用一条「资产流动」的线，把各名词串起来：
```
助记词（12/24 个英文单词）
    └─ 是「随机数种子」的人类可读版 → 唯一且万能。
私钥（256 bit 十六进制串）
    └─ 由助记词按标准算法（BIP-32/44）派生而来 → 不同链的一条链一个私钥，但可无限生成。
链 / 网络（Bitcoin、Ethereum、TRON、BSC…）
    └─ 不同公链运行不同账本 → 各链用各自的地址格式与签名规则。
    例：Bitcoin 链 ≠ Ethereum 链，彼此不互通。
钱包地址
    └─ 由「私钥 + 链规则」算出的公开收款账号 → 一条链可派生无数地址，但常用默认第一个。
    例：同一助记词在 Ethereum 上生成 0xAbC…，在 TRON 上生成 TXyz…。
币 / 代币
    └─ 就是链上余额的“单位”，分两类：
    原生币：BTC 只跑在 Bitcoin 链，ETH 只跑在 Ethereum 链。
    代币：USDT、USDC 等合约资产 → 同一符号可在多条链发行（ERC-20、TRC-20、BEP-20），但彼此独立。
```
对应关系一句话
“助记词 → 派生私钥 → 按链规则生成地址 → 地址里存币 → 链负责记账。”
助记词是根，私钥是钥匙，地址是门牌，链是街道，币是房子里的资产；走错街道（链）就找不到房子（币）。

图解记忆
```
助记词（根），根据不同链/网络进行派生
   │
   ├─Bitcoin 私钥→ bc1 地址→ 存 BTC
   ├─Ethereum 私钥→ 0x 地址→ 存 ETH & USDT-ERC20
   └─TRON 私钥→ T 地址→ 存 TRX & USDT-TRC20
```


^


#### **助记词泄露**
1. 拿到助记词 → 可以离线算出**所有私钥** → 从而能签名**任何一笔转账**。
2. 但“转走”仍然要**把这笔签名后的交易广播到对应区块链网络**并被打包确认；没有网络就做不到“瞬间”转移。
3. 因此hacker通常会把助记词导入自己的联网钱包（或脚本），再发起链上转账——整个过程几分钟即可完成，对受害者而言就是“币突然被转空”。

总结：
助记词 = 能签名 = 能转走；
只要泄露，别人随时可以把资产发到链上，不需要受害者任何二次确认。


