在Active Directory（AD）环境中，委派是一种机制，它允许一个域账户模拟另一个账户来执行特定的任务或访问特定的资源，而无需共享密码。委派主要用于简化管理任务并减少对高权限账户（如域管理员）的直接需求。
委派可以分为几种类型：

1. **非约束委派（Unconstrained Delegation）**：

   * 在非约束委代中，一个账户（通常是域用户账户）可以委派给另一个账户（可以是域内任何位置的账户），后者可以模拟第一个账户来访问任何资源。这种委代方式风险较高，因为它没有限制被委代账户可以模拟原始账户访问的资源。
![image-20240611163618451](http://cdn.33129999.xyz/mk_img/image-20240611163618451.png)

2. **约束委派（Constrained Delegation）**：

   * 约束委代提供了更多的安全性，因为它允许管理员指定被委代账户只能模拟原始账户来访问特定的服务或资源。这意味着即使攻击者获得了被委代账户的凭据，他们也无法访问委代账户所能访问的所有资源，只能访问那些明确指定的服务或资源。

3. **资源约束委派（Resource-Based Constrained Delegation）**：

   * 资源约束委代是约束委代的一种更细化的形式，它允许资源的所有者（例如，一个文件服务器的管理员）明确指定哪些账户可以委派到该资源。在这种委代中，资源的所有者可以直接控制哪些账户有权限委派到他们的资源，而不需要通过域管理员来设置。

在内网横向移动的上下文中，委代可以用来在不同的系统或服务之间传递权限。攻击者如果能够利用委代，尤其是非约束委代，就可以在内网中获得更广泛的访问权限，从而横向移动到其他系统。因此，合理配置和监控委代关系对于维护内网安全至关重要。

安全最佳实践包括：

* 仅对确实需要委代的服务或资源启用委代。
* 使用约束委代而非非约束委代，以减少潜在的安全风险。
* 对委代关系进行定期的审查和监控，以确保它们被正确和安全地使用。



^
清晰理解：
<https://xz.aliyun.com/t/10061?time__1311=mq%2BxBD9QDQdQq40y3bDyCYG8CdLorTD&alichlgref=https%3A%2F%2Fwww.baidu.com%2Flink%3Furl%3D9WHKwcL3BT7VqDltL-g2G1dPjHvNpKohvjbSlYxiIve_scEaXBwtuyyrpDv4Fauf%26wd%3D%26eqid%3Db417ec420014935c0000000666680ad5>
详细：
<https://blog.csdn.net/qq_62169455/article/details/136499820>

