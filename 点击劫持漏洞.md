
<https://cloud.tencent.com/developer/article/1516375>



点击劫持（Click Jacking）是一种视觉上的欺骗手段，攻击者通过使用一个透明的iframe，覆盖在一个网页上，然后诱使用户在该页面上进行操作，通过调整iframe页面的位置，可以使得伪造的页面恰好和iframe里受害页面里一些功能重合（按钮），以达到窃取用户信息或者劫持用户操作的目的。

点击劫持是一种基于界面的攻击，通过诱骗用户，使其单击诱饵网站中的其他内容，但他实际上单击的是网站中经过隐藏的可操作内容。请考虑以下示例：
一个网络用户访问了某个诱饵投放网站（也许这是通过电子邮件提供的链接），然后单击了一个按钮以赢得奖品。在不知不觉中，他们被攻击者欺骗，按下了另一个隐藏按钮，这导致该用户 在另一个网站上的帐户 进行了支付。这是一个点击劫持攻击的例子。

该技术依赖于`iframe`标签，这将在其中包含一个不可见的、可操作的网页（或多个网页），该网页中又包含 隐藏的按钮或链接。`iframe`覆盖在用户预期的诱饵网页内容之上。这种攻击与 CSRF 攻击的不同之处在于，用户需要执行 单击按钮 之类的操作，而CSRF攻击依赖于 在用户不知情的情况下 伪造整个请求。


Clickjacking是仅次于XSS和CSRF的前端漏洞，因为需要诱使用户交互，攻击成本高，所以不被重视，但危害不容小觑。
当受害者接收到投放的页面以后点击就会因为点击劫持危害操作。


## **测试**

漏洞挖掘思路较为简单，观察业务系统中重要操作，返回包里是否有X-FRAME头或CSP头，若不存在则尝试使用iframe包含此链接，若框架内能正常显示链接的内容，则存在点解劫持风险。
![](.topwrite/assets/image_1728697415580.png)


对于可能存在点击劫持的网页，可以使用Burp左上角的Clickbandit工具复制js，到F12控制台运行生成并保存测试点击劫持网页代码。


## **防御**
主要有三种防御办法：

1）X-Frame-Options，建议设置为DENY；

2）Content-Security-Policy:frame-ancestors 'self'或‘none’，不适用于Safari和IE；

3）js层面：使用iframe的sandbox属性，判断当前页面是否被其他页面嵌套。


