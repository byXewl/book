利用跨站的js偷cookie,等js可以实现的功能。
当用户或管理员使用浏览器加载被嵌入恶意代码的网页时，恶意脚本代码就会在用户的浏览器执行，造成跨站脚本的攻击，可以配合csrf造成更大危害。


XSS攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入恶意指令代码到网页，使用户加载并执行攻击者恶意制造的网页程序。这些恶意网页程序通常是JavaScript，但实际上也可以包括Java，VBScript，ActiveX，Flash或者甚至是普通的HTML。攻击成功后，攻击者可能得到更高的权限（如执行一些操作）、私密网页内容、会话和cookie等各种内容。

```
1.盗用cookie，获取敏感信息。
2.利用植入Flash，通过crossdomain权限设置进一步获取更高权限；或者利用Java等得到类似的操作。
3.利用iframe、frame、XMLHttpRequest或上述Flash等方式，
以（被攻击）用户的身份执行一些管理动作，或执行一些一般的操作如发微博、加好友、发私信等操作。
4.利用可被攻击的域受到其他域信任的特点，以受信任来源的身份请求一些平时不允许的操作，
如 进行不当的投票活动。
5.在访问量极大的一些页面上的XSS可以攻击一些小型网站，实现DDOS攻击的效果。
```



## **场景**
搜索框，购物车，地址信息，网站配置文件，用户资料，文章发布，论坛帖子，留言，sql注入点报错回显，mk的渲染。


## **分类**
1. 反射型：只存在本地非持久，输入构建进行标签。基本没有危害，但如果可以嵌入url中页面会回显，可以让用户点击，也有危害。
* 构造场景如URL参数、错误消息、HTTP头等。
* 恶意代码通常由用户自己提交到服务器，然后服务器未经验证和清理就将代码回传给用户。
* 需要诱骗用户点击一个恶意链接，或者在表单中提交特定的输入。

2. 存储型：注入的js代码可以长期存在，如发布的帖子。

3. dom型：DOM型是直接给前端进行处理，只在本地浏览器存在，然后回显的，不需要后台执行。构建dom，闭合dom，标签闭合，闭合标签属性。
```
<img src="1" onerror="alert(1)" >  //图片地址已经出错了就加载alert()

onerror="alert(1) //'   "
``` 



XSS跨站点脚本注入常常出现在浏览器客户端输出时由于未对输出的数据进行过滤和转换，导致浏览器响应执行了Javascript代码，这个代码代具有管理员权限的用户做一些隐藏的操作，比如提权、恶意修改删除数据，甚至将用户当前浏览器端的Cookie等数据传到攻击者的服务器，攻击者通过伪造Cookie请求，很容易造成用户信息漏洞和数据丢失的情况。这种问题常出现在会员昵称、会员头像输出、会员评论数据等情况下。
^
php解决防范XSS跨站注入的首先是按照上方的SQL注入做好请求数据过滤，其次是做好数据输出时的编码，我们在视图模板中编写代码时，可以通过添加`htmlentities`对HTML代码做实体编码，例如
```
<input type="text" name="username" value="{$username|htmlentities}" />
```

千万不要直接使用以下的代码，以下代码都是非常不安全的

```
<input type="text" name="username" value="{$Think.get.username}" />
或
<input type="text" name="username" value="{$_GET['username']}" />
```

